# 📅 日本時間スケジュール設定ガイド

## ⏰ 稼働時間
**日本時間：月曜朝7時 〜 土曜朝6時（15分毎）**

## 🌍 タイムゾーン変換
EventBridgeはUTC時間で設定するため、以下の変換が必要：

| 日本時間（JST） | UTC時間 | 曜日変換 |
|----------------|---------|----------|
| 月曜 07:00     | 日曜 22:00 | SUN → MON |
| 土曜 06:00     | 金曜 21:00 | SAT → FRI |

## 🔧 EventBridge設定（3つのルールが必要）

### 1. 月曜開始ルール
```
cron(*/15 22 * * 0)
```
- **日曜22時〜23時45分（UTC）**
- **月曜7時〜8時45分（JST）**

### 2. 平日継続ルール  
```
cron(*/15 * * * 1-5)
```
- **月〜金曜日 00:00〜23:45（UTC）**
- **月〜金曜日 09:00〜翌8:45（JST）**

### 3. 土曜終了ルール
```
cron(*/15 0-21 * * 6)
```
- **土曜00:00〜21:45（UTC）**
- **土曜09:00〜翌6:45（JST）**

## 📊 実行回数
- **日曜**: 8回（22:00〜23:45）
- **月〜金**: 96回/日（24時間 × 4回/時）
- **土曜**: 88回（00:00〜21:45）
- **週合計**: 約566回

## ⚙️ AWS Console設定手順

### 1. EventBridge → ルールの作成（3回実行）

#### ルール1: `divergence-checker-monday-start`
- スケジュール: `cron(*/15 22 * * 0)`
- ターゲット: Lambda function `divergence-checker`

#### ルール2: `divergence-checker-weekdays`
- スケジュール: `cron(*/15 * * * 1-5)`  
- ターゲット: Lambda function `divergence-checker`

#### ルール3: `divergence-checker-saturday-end`
- スケジュール: `cron(*/15 0-21 * * 6)`
- ターゲット: Lambda function `divergence-checker`

## 🚦 稼働状況確認

### 日本時間での稼働タイムライン
```
日曜 22:00(JST) = 月曜 07:00(JST) ✅ 開始
月曜 09:00(JST) ✅ 継続  
...
金曜 23:45(JST) ✅ 継続
土曜 05:45(JST) ✅ 終了
土曜 06:00(JST) ❌ 停止
```

## 💡 Tips

### 時間確認方法
```bash
# 現在のUTC時間
date -u
# 現在の日本時間  
TZ=Asia/Tokyo date
```

### テスト実行
各ルールでテスト実行を行い、正しい時間に動作することを確認

### 監視
CloudWatch Logsで実行ログを確認し、想定通りの頻度で実行されているかモニタリング

## ⚠️ 注意事項
- 夏時間は考慮不要（日本は夏時間なし）
- 3つのルール全てが必要（1つのcron式では表現不可）
- 各ルールのターゲットは同じLambda関数を指定